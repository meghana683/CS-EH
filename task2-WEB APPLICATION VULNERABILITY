import requests, urllib.parse
from bs4 import BeautifulSoup

SQLI_TESTS = ["' OR 1=1--", "';--"]
XSS_TESTS = ['<script>alert(1)</script>']

def get_forms(url):
    return BeautifulSoup(requests.get(url).text, "html.parser").find_all("form")

def extract_form_data(form):
    return {
        "action": form.get("action"),
        "method": form.get("method", "get").lower(),
        "inputs": [i.get("name") for i in form.find_all("input") if i.get("name")]
    }

def submit_form(url, form, payload):
    data = {name: payload for name in form["inputs"]}
    target = urllib.parse.urljoin(url, form["action"])
    return requests.post(target, data=data) if form["method"] == "post" else requests.get(target, params=data)

def scan(url):
    print(f"Scanning: {url}")
    
    for payload in SQLI_TESTS + XSS_TESTS:
        test_url = f"{url}?q={urllib.parse.quote(payload)}"
        if payload in requests.get(test_url).text:
            print(f"[!] URL vulnerable to: {payload}")
    
    for form in get_forms(url):
        form_data = extract_form_data(form)
        for payload in SQLI_TESTS + XSS_TESTS:
            res = submit_form(url, form_data, payload)
            if payload in res.text:
                print(f"[!] Form vulnerable to: {payload}")

if __name__ == "__main__":
    url = input("Enter target URL: ").strip()
    if not url.startswith("http"):
        url = "http://" + url
    scan(url)
